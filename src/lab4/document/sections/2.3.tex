\graphicspath{{images/act_2.3/}}
\subsection{Inverse dynamics based impedance control}
The objective of this activity is analyze the effects of inertia ($\boldsymbol{\Lambda}$) on the dynamic relation between interaction forces ($\fext$) and Cartesian configuration ($\cartesianconfiguration$). For this purpose, a simulation environment is developed that contains the UR5 robot and allows external forces to be applied. The simulation starts with robot end-effector Cartesian position $\mathbf{p_0}=\begin{bmatrix}  0.577 &   0.192 &   0.364 \end{bmatrix}$~m. Then, external force $\mathbf{f_{ext}}= 50\sin{(2\pi t)}$ N is applied to robot end-effector. Finally, motion control is made up of two approaches: Cartesian inverse dynamics based impedance control and projection of the null space. In this sense, Cartesian inverse dynamics based impedance control focuses on set desired dynamic behavior and the projection of null space maintains the articular position close to $\mathbf{q_0}$. Finally, control law can be computed as 
\begin{equation}
	\boldsymbol{\tau}
	= \mathbf{J^T} (\boldsymbol{\Lambda}( \mathbf{\ddot{p}_{des}} + \mathbf{K_{des} e} + \mathbf{D_{des}\dot{e}}) + \boldsymbol{\mu})+ \mathbf{N} \left(\mathbf{K_q(q_0-q) - D_q \dot{q}} \right),
	\label{eq:cartesian_idyn_N}
\end{equation} 
\begin{align*}
	\boldsymbol{\Lambda} &= (\mathbf{J M^{-1} J^{T}})^{-1}, \\
	\boldsymbol{\mu} &= \mathbf{J^{T\#}} - \boldsymbol{\Lambda}\mathbf{\dot{J}\dot{q}}, \\
	\mathbf{N} &=(\mathbf{I_{6 \times 6}} - \mathbf{J^{\#} J} ),
\end{align*}

\noindent where $\mathbf{J}$ is geometric jacobian matrix, $\boldsymbol{\Lambda}$ is inertia matrix at Cartesian space, $\mathbf{e}=\mathbf{p_{des} - p}$ is end-effector position error, and $\mathbf{K_{des}, D_{des}}$ are desired stiffness and damping, respectively; $\mathbf{J^{\#}}$ is jacobian damped pseudo-inverse, $\boldsymbol{\mu}$ is nonlinear effects vector at cartesian space, $\mathbf{N}$ is the null space projection of $\mathbf{J^{\#}}$, and $\mathbf{K_q, D_q}$ are the proportional and derivative gains for null space projection. 

Figure \ref{fig:act2.3_external_force_vs_cartesian_configuration} shows the dynamics relation between external force ($\fext$) and cartesian configuration ($\cartesianconfiguration$) using control law \eqref{eq:cartesian_idyn_N} with $\mathbf{K_{des}}=500\eye$ and $\mathbf{D_{des}}=50\eye$. In these figures, similar dynamic behaviors are observed in Cartesian position and velocity graphs due to compensation for inertia, gravitational and Coriolis effects. Finally, differences in Cartesian acceleration graphs could be generated by null space terms.

\begin{figure}
\centering
\subfloat[]{\includegraphics{external_force_vs_cartesian_position.eps} \label{fig:act2.3_force_vs_p}}
\subfloat[]{\includegraphics{external_force_vs_cartesian_velocity.eps} \label{fig:act2.3_force_vs_dp}}
\subfloat[]{\includegraphics{external_force_vs_cartesian_acceleration.eps} \label{fig:act2.3_force_vs_ddp}}
\caption{Dynamic relation between external force ($\fext$) and Cartesian configuration ($\cartesianconfiguration$) using inverse dynamic based impedance control \eqref{eq:cartesian_idyn_N} with $\mathbf{K_{des}}=500\eye$ and $\mathbf{D_{des}}=50\eye$: (a) position, (b) velocity and (c) acceleration.}
\label{fig:act2.3_external_force_vs_cartesian_configuration}
\end{figure}
